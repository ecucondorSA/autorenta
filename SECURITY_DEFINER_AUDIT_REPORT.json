{
  "timestamp": "2025-11-19T22:40:19.061Z",
  "summary": {
    "total_functions": 14,
    "critical": 9,
    "high": 5,
    "medium": 0,
    "audited": 1,
    "pending": 8
  },
  "critical_functions": [
    {
      "name": "wallet_confirm_deposit_admin",
      "schema": "public",
      "risk_level": "critical",
      "recommendation": "✅ YA AUDITADA - Tiene validación de roles",
      "status": "AUDITADA"
    },
    {
      "name": "wallet_lock_rental_payment",
      "schema": "public",
      "risk_level": "critical",
      "recommendation": "Auditar - Bloqueo de fondos",
      "status": "PENDIENTE"
    },
    {
      "name": "wallet_charge_rental",
      "schema": "public",
      "risk_level": "critical",
      "recommendation": "Auditar - Cargo de alquiler",
      "status": "PENDIENTE"
    },
    {
      "name": "wallet_refund",
      "schema": "public",
      "risk_level": "critical",
      "recommendation": "Auditar - Reembolsos",
      "status": "PENDIENTE"
    },
    {
      "name": "wallet_transfer_to_owner",
      "schema": "public",
      "risk_level": "critical",
      "recommendation": "Auditar - Transferencias a owners",
      "status": "PENDIENTE"
    },
    {
      "name": "wallet_withdraw",
      "schema": "public",
      "risk_level": "critical",
      "recommendation": "Auditar - Retiros",
      "status": "PENDIENTE"
    },
    {
      "name": "process_payment",
      "schema": "public",
      "risk_level": "critical",
      "recommendation": "Auditar - Procesamiento de pagos",
      "status": "PENDIENTE"
    },
    {
      "name": "split_payment",
      "schema": "public",
      "risk_level": "critical",
      "recommendation": "Auditar - División de pagos",
      "status": "PENDIENTE"
    },
    {
      "name": "process_mercadopago_webhook",
      "schema": "public",
      "risk_level": "critical",
      "recommendation": "Auditar - Webhooks de MercadoPago",
      "status": "PENDIENTE"
    }
  ],
  "high_functions": [
    {
      "name": "request_booking",
      "schema": "public",
      "risk_level": "high",
      "recommendation": "Auditar - Creación de bookings"
    },
    {
      "name": "approve_booking",
      "schema": "public",
      "risk_level": "high",
      "recommendation": "Auditar - Aprobación de bookings"
    },
    {
      "name": "cancel_booking",
      "schema": "public",
      "risk_level": "high",
      "recommendation": "Auditar - Cancelación de bookings"
    },
    {
      "name": "create_journal_entry",
      "schema": "public",
      "risk_level": "high",
      "recommendation": "Auditar - Entradas contables"
    },
    {
      "name": "close_accounting_period",
      "schema": "public",
      "risk_level": "high",
      "recommendation": "Auditar - Cierre de períodos"
    }
  ],
  "next_steps": [
    "Auditar 8 funciones críticas restantes",
    "Tiempo estimado: 2 horas",
    "Aplicar validación de roles en cada función",
    "Ejecutar tests para verificar funcionalidad"
  ]
}