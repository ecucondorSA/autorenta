# Cloudflare Pages - _redirects
# https://developers.cloudflare.com/pages/platform/redirects
# Este archivo se copia automáticamente al build y se sobrescribe por create-cloudflare-config.js

# App download redirects (short URLs for social media)
/app      https://play.google.com/apps/test/app.autorentar/70    302
/android  https://play.google.com/apps/test/app.autorentar/70    302
/descarga https://play.google.com/apps/test/app.autorentar/70    302

# Fix broken relative asset loads when entering the SPA from a nested route.
#
# Cloudflare can emit `Link: <chunk-XYZ.js>; rel=modulepreload` headers based on the HTML.
# When the browser resolves that relative URL under `/cars/publish`, it requests `/cars/chunk-XYZ.js`.
# Those files only exist at the site root, so without this redirect Cloudflare would serve the SPA
# fallback HTML (text/html) and Chrome will throw strict MIME errors for module scripts.
#
# NOTE: Cloudflare redirects support only 301/302/303/307/308 and 200 rewrites.
# We keep this as a redirect to the canonical root asset.
/:section/chunk-* /chunk-:splat 302
/:section/main-* /main-:splat 302
/:section/polyfills-* /polyfills-:splat 302
/:section/styles-* /styles-:splat 302

/:a/:b/chunk-* /chunk-:splat 302
/:a/:b/main-* /main-:splat 302
/:a/:b/polyfills-* /polyfills-:splat 302
/:a/:b/styles-* /styles-:splat 302

# SPA route fallbacks — explicit patterns instead of catch-all.
# WHY: A catch-all `/* /index.html 200` returns HTML (200) for missing .js chunks,
# which turns the Service Worker into a zombie. With explicit routes, missing static
# assets correctly get a 404 from Cloudflare Pages, breaking the stale-SW loop.

# Core app routes
/rentarfast       /index.html   200
/onboarding       /index.html   200
/become-renter    /index.html   200
/ganar            /index.html   200
/referrals        /index.html   200
/favorites        /index.html   200
/mp-callback      /index.html   200
/protections      /index.html   200
/finanzas         /index.html   200
/calendar-demo    /index.html   200
/payouts          /index.html   200
/support          /index.html   200
/panic            /index.html   200
/beacon-test      /index.html   200

# Auth & identity
/auth/*           /index.html   200
/oauth/*          /index.html   200
/verification/*   /index.html   200
/contact-verification/* /index.html 200

# Domain features (nested routes)
# NOTE: /path/* matches /path/foo but NOT /path alone. Both are needed.
/cars              /index.html   200
/cars/*            /index.html   200
/bookings          /index.html   200
/bookings/*        /index.html   200
/reviews           /index.html   200
/reviews/*         /index.html   200
/wallet            /index.html   200
/wallet/*          /index.html   200
/dashboard         /index.html   200
/dashboard/*       /index.html   200
/profile           /index.html   200
/profile/*         /index.html   200
/scout             /index.html   200
/scout/*           /index.html   200
/messages          /index.html   200
/messages/*        /index.html   200
/notifications     /index.html   200
/notifications/*   /index.html   200
/admin             /index.html   200
/admin/*           /index.html   200
/ref/*             /index.html   200
/users/*           /index.html   200

# Legal & static pages
/terminos         /index.html   200
/terms            /index.html   200
/privacy          /index.html   200
/delete-account   /index.html   200
/politica-seguros /index.html   200
/help             /index.html   200
/aircover         /index.html   200
/safety           /index.html   200
/cancellation     /index.html   200
/community        /index.html   200
/rent-your-car    /index.html   200
/owner-resources  /index.html   200
/resources        /index.html   200
/newsroom         /index.html   200
/about            /index.html   200
/careers          /index.html   200
/investors        /index.html   200
/sitemap          /index.html   200
/company-data     /index.html   200

# SEO & error pages
/alquiler/*       /index.html   200
/error/*          /index.html   200
