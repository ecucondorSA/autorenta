/**
 * Accessibility Utilities
 *
 * WCAG 2.2 compliant utilities for:
 * - Touch targets (44x44px minimum per WCAG 2.2 AAA)
 * - Focus visibility
 * - Reduced motion support
 * - Screen reader utilities
 * - High contrast support
 */

/* ===== Touch Targets ===== */

/**
 * Minimum touch target size (WCAG 2.2 Level AAA)
 * Use on interactive elements that need larger hit areas
 */
.touch-target {
  min-width: 44px;
  min-height: 44px;
  display: inline-flex;
  align-items: center;
  justify-content: center;
}

/**
 * Touch target with padding (for text buttons)
 * Adds padding to achieve minimum size while keeping visual size smaller
 */
.touch-target-padded {
  position: relative;
  padding: 12px;
}

.touch-target-padded::before {
  content: '';
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  min-width: 44px;
  min-height: 44px;
  width: 100%;
  height: 100%;
}

/**
 * Compact touch target (WCAG 2.2 Level AA - 24x24px)
 * Use only when space is extremely limited
 */
.touch-target-compact {
  min-width: 24px;
  min-height: 24px;
  display: inline-flex;
  align-items: center;
  justify-content: center;
}

/* ===== Focus Visibility ===== */

/**
 * Focus ring - visible only on keyboard navigation
 * Uses :focus-visible for modern browsers
 */
.focus-visible-ring:focus-visible {
  outline: 2px solid var(--neon-primary, #00d95f);
  outline-offset: 2px;
}

/**
 * Focus ring - high contrast alternative
 */
.focus-visible-ring-contrast:focus-visible {
  outline: 3px solid var(--text-primary, #1a1a1a);
  outline-offset: 2px;
  box-shadow: 0 0 0 6px var(--surface-base, #ffffff);
}

/**
 * Focus within container - highlights parent when child is focused
 */
.focus-within-ring:focus-within {
  outline: 2px solid var(--neon-primary, #00d95f);
  outline-offset: 2px;
}

/**
 * Remove default focus outline (use sparingly, always provide alternative)
 */
.focus-outline-none:focus {
  outline: none;
}

/* ===== Skip Links ===== */

/**
 * Skip to main content link
 * Visible only on focus for keyboard users
 */
.skip-link {
  position: fixed;
  top: -100%;
  left: 50%;
  transform: translateX(-50%);
  background: var(--surface-base, #ffffff);
  color: var(--text-primary, #1a1a1a);
  padding: 12px 24px;
  border-radius: 8px;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
  z-index: 9999;
  font-weight: 600;
  text-decoration: none;
  transition: top 0.2s ease;
}

.skip-link:focus {
  top: 16px;
}

/* ===== Screen Reader Utilities ===== */

/**
 * Visually hidden but accessible to screen readers
 */
.sr-only {
  position: absolute;
  width: 1px;
  height: 1px;
  padding: 0;
  margin: -1px;
  overflow: hidden;
  clip: rect(0, 0, 0, 0);
  white-space: nowrap;
  border: 0;
}

/**
 * Visually hidden until focused (for skip links)
 */
.sr-only-focusable:focus,
.sr-only-focusable:active {
  position: static;
  width: auto;
  height: auto;
  padding: inherit;
  margin: inherit;
  overflow: visible;
  clip: auto;
  white-space: normal;
}

/**
 * Hide from screen readers (decorative elements)
 */
.aria-hidden {
  aria-hidden: true;
}

/* ===== Reduced Motion ===== */

/**
 * Respect user preference for reduced motion
 * Apply to elements with animations/transitions
 */
@media (prefers-reduced-motion: reduce) {
  .motion-safe,
  [class*='animate-'],
  [class*='transition-'] {
    animation-duration: 0.01ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.01ms !important;
    scroll-behavior: auto !important;
  }
}

/**
 * Only animate when user prefers motion
 */
@media (prefers-reduced-motion: no-preference) {
  .motion-reduce {
    animation: none;
    transition: none;
  }
}

/* ===== High Contrast Mode ===== */

/**
 * Forced colors mode support (Windows High Contrast)
 */
@media (forced-colors: active) {
  .hc-border {
    border: 2px solid CanvasText;
  }

  .hc-focus:focus {
    outline: 3px solid Highlight;
    outline-offset: 2px;
  }

  .hc-button {
    background: ButtonFace;
    color: ButtonText;
    border: 2px solid ButtonText;
  }

  .hc-button:hover {
    background: Highlight;
    color: HighlightText;
  }
}

/* ===== Text Accessibility ===== */

/**
 * Minimum readable text size
 * Never go below 12px for body text
 */
.text-readable {
  font-size: max(1rem, 12px);
  line-height: 1.5;
}

/**
 * High contrast text
 * Ensures 4.5:1 contrast ratio minimum
 */
.text-high-contrast {
  color: var(--text-primary, #1a1a1a);
}

/**
 * Link styling with underline (more accessible than color alone)
 */
.link-accessible {
  color: var(--neon-primary, #00d95f);
  text-decoration: underline;
  text-underline-offset: 2px;
}

.link-accessible:hover {
  text-decoration-thickness: 2px;
}

.link-accessible:focus-visible {
  outline: 2px solid var(--neon-primary, #00d95f);
  outline-offset: 2px;
  text-decoration: none;
}

/* ===== Interactive Element Indicators ===== */

/**
 * Visual indicator for disabled state
 */
.disabled-state,
[disabled],
[aria-disabled='true'] {
  opacity: 0.5;
  cursor: not-allowed;
  pointer-events: none;
}

/**
 * Loading state with aria-busy
 */
[aria-busy='true'] {
  cursor: wait;
}

/**
 * Expanded/collapsed indicator
 */
[aria-expanded='true']::after {
  content: '';
  /* Icon rotation handled by component */
}

/* ===== Form Accessibility ===== */

/**
 * Required field indicator
 */
.required-indicator::after {
  content: ' *';
  color: var(--error-default, #ef4444);
  font-weight: 700;
}

/**
 * Error state for form fields
 */
.field-error {
  border-color: var(--error-default, #ef4444);
}

.field-error:focus {
  outline-color: var(--error-default, #ef4444);
  box-shadow: 0 0 0 3px var(--error-light, #fee2e2);
}

/**
 * Success state for form fields
 */
.field-success {
  border-color: var(--success-default, #10b981);
}

.field-success:focus {
  outline-color: var(--success-default, #10b981);
  box-shadow: 0 0 0 3px var(--success-light, #d1fae5);
}

/* ===== Mobile-specific Touch Targets ===== */

@media (max-width: 768px) {
  /**
   * Larger touch targets on mobile
   */
  .touch-target-mobile {
    min-width: 48px;
    min-height: 48px;
  }

  /**
   * Increase spacing between interactive elements
   */
  .touch-spacing > * + * {
    margin-top: 8px;
  }

  .touch-spacing-horizontal > * + * {
    margin-left: 8px;
  }
}

/* ===== Focus Trap Utility ===== */

/**
 * Container for focus trap (modals, dialogs)
 * Use with focusTrap directive
 */
.focus-trap-container {
  position: relative;
}

.focus-trap-container:focus-within {
  /* Visual indication that focus is trapped */
}

/* ===== Color Blind Support ===== */

/**
 * Don't rely on color alone - add icons/patterns
 */
.status-indicator {
  display: inline-flex;
  align-items: center;
  gap: 4px;
}

.status-indicator::before {
  content: '';
  width: 8px;
  height: 8px;
  border-radius: 50%;
}

.status-success::before {
  background: var(--success-default, #10b981);
  /* Also add checkmark icon in component */
}

.status-error::before {
  background: var(--error-default, #ef4444);
  /* Also add X icon in component */
}

.status-warning::before {
  background: var(--warning-default, #f59e0b);
  /* Also add warning icon in component */
}

.status-info::before {
  background: var(--info-default, #3b82f6);
  /* Also add info icon in component */
}
