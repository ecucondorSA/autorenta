<div 
  *ngIf="isWCOActive()" 
  class="pwa-titlebar"
  [style.height.px]="titlebarRect()?.height || 40"
>
  <!-- Región draggable (izquierda) -->
  <div class="titlebar-drag-region">
    <button 
      class="titlebar-logo-btn" 
      (click)="navigateToHome()"
      type="button"
      aria-label="Ir al inicio"
    >
      <svg class="titlebar-logo" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
        <circle cx="7" cy="17" r="2" stroke="currentColor" stroke-width="1.5"/>
        <circle cx="17" cy="17" r="2" stroke="currentColor" stroke-width="1.5"/>
        <path d="M5 15h14M8 12l1-4h6l1 4" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5"/>
      </svg>
      <span class="titlebar-brand">AutoRenta</span>
    </button>
  </div>

  <!-- Acciones centrales (no draggable) -->
  <div class="titlebar-actions">
    <div class="titlebar-search">
      <svg class="titlebar-search-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
      </svg>
      <input 
        type="search" 
        class="titlebar-search-input" 
        placeholder="Buscar autos..."
        (focus)="navigateToSearch()"
        readonly
      />
    </div>

    <button 
      class="titlebar-btn" 
      (click)="navigateToProfile()"
      type="button"
      [attr.aria-label]="isAuthenticated() ? 'Ver perfil' : 'Iniciar sesión'"
    >
      <svg *ngIf="!isAuthenticated()" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path>
      </svg>
      <img 
        *ngIf="isAuthenticated() && userProfile()?.avatar_url" 
        [src]="userProfile()?.avatar_url" 
        [alt]="userProfile()?.full_name || 'Usuario'"
        class="titlebar-avatar"
      />
      <svg *ngIf="isAuthenticated() && !userProfile()?.avatar_url" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5.121 17.804A13.937 13.937 0 0112 16c2.5 0 4.847.655 6.879 1.804M15 10a3 3 0 11-6 0 3 3 0 016 0z"></path>
      </svg>
    </button>
  </div>

  <!-- Espaciador derecho para los controles de Windows -->
  <div 
    class="titlebar-spacer"
    [style.width.px]="140"
  ></div>
</div>
