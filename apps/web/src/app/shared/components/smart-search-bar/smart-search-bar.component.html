<div class="smart-search-container bg-surface-raised/90 backdrop-blur-xl p-4 rounded-3xl shadow-2xl border border-white/20 flex flex-col md:flex-row gap-4 items-center">
  
  <!-- Location Input -->
  <div class="relative w-full md:w-1/3 group">
    <div class="flex items-center bg-surface-secondary/50 rounded-2xl px-4 py-3 border border-transparent group-focus-within:border-cta-default transition-all">
      <svg class="w-5 h-5 text-text-secondary mr-3 group-focus-within:text-cta-default" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z" />
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z" />
      </svg>
      <input 
        type="text" 
        [ngModel]="locationQuery()"
        (input)="onLocationInput($event)"
        placeholder="¿Dónde retirás?" 
        class="bg-transparent border-none outline-none w-full text-text-primary placeholder:text-text-muted font-medium"
      >
      @if (locationQuery().length === 0) {
        <button (click)="useCurrentLocation()" class="p-1 hover:bg-white/10 rounded-full" aria-label="Usar ubicación actual">
          <svg class="w-5 h-5 text-cta-default" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" />
          </svg>
        </button>
      }
    </div>

    <!-- Suggestions Dropdown -->
    @if (showSuggestions() && locationSuggestions().length > 0) {
      <div class="absolute top-full left-0 w-full mt-2 bg-surface-raised rounded-xl shadow-xl border border-border-default overflow-hidden z-50">
        @for (suggestion of locationSuggestions(); track suggestion.placeName) {
          <button (click)="selectLocation(suggestion)" class="w-full text-left px-4 py-3 hover:bg-surface-secondary flex items-center gap-3 transition-colors border-b border-border-subtle last:border-0">
            <svg class="w-4 h-4 text-text-muted" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z" />
            </svg>
            <span class="text-sm text-text-primary truncate">{{ suggestion.placeName }}</span>
          </button>
        }
      </div>
    }
  </div>

  <!-- Date Picker (Integrated) -->
  <div class="w-full md:w-1/3">
    <app-date-range-picker 
      [compact]="true" 
      label="¿Cuándo viajás?"
      (rangeChange)="onDateRangeChange($event)"
    ></app-date-range-picker>
  </div>

  <!-- Search Button -->
  <div class="w-full md:w-auto ml-auto">
    <button (click)="submitSearch()" class="w-full md:w-auto px-8 py-3 bg-cta-default hover:bg-cta-hover text-cta-text font-black rounded-xl shadow-lg hover:shadow-cta-default/30 transform hover:-translate-y-0.5 transition-all flex items-center justify-center gap-2">
      <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
      </svg>
      BUSCAR
    </button>
  </div>
</div>
