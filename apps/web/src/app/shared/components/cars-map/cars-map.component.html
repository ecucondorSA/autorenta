<div class="cars-map-container">
  <!-- Loading State -->
  <div *ngIf="loading()" class="map-overlay loading-overlay">
    <div class="spinner"></div>
    <p>Cargando mapa de autos disponibles...</p>
  </div>

  <!-- Error State -->
  <div *ngIf="error() && !loading()" class="map-overlay error-overlay">
    <div class="error-content">
      <svg class="error-icon" fill="none" viewBox="0 0 24 24" stroke="currentColor">
        <path
          stroke-linecap="round"
          stroke-linejoin="round"
          stroke-width="2"
          d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"
        />
      </svg>
      <p class="error-message">{{ error() }}</p>
      <button class="retry-button" (click)="refreshMap()">Reintentar</button>
    </div>
  </div>

  <!-- Map Info Bar -->
  <div *ngIf="!loading() && !error()" class="map-info-bar">
    <div class="info-content">
      <svg class="info-icon" fill="none" viewBox="0 0 24 24" stroke="currentColor">
        <path
          stroke-linecap="round"
          stroke-linejoin="round"
          stroke-width="2"
          d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"
        />
        <path
          stroke-linecap="round"
          stroke-linejoin="round"
          stroke-width="2"
          d="M15 11a3 3 0 11-6 0 3 3 0 016 0z"
        />
      </svg>
      <span class="info-text">
        <strong>{{ carCount() }}</strong>
        {{ carCount() === 1 ? 'auto disponible' : 'autos disponibles' }}
      </span>
    </div>
    <button class="refresh-button" (click)="refreshMap()" title="Actualizar ubicaciones">
      <svg fill="none" viewBox="0 0 24 24" stroke="currentColor">
        <path
          stroke-linecap="round"
          stroke-linejoin="round"
          stroke-width="2"
          d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"
        />
      </svg>
    </button>
  </div>

  <!-- Map Container -->
  <div #mapContainer class="map-canvas"></div>

  <!-- Map Legend -->
  <div *ngIf="!loading() && !error()" class="map-legend">
    <div class="legend-item">
      <div class="legend-marker"></div>
      <span>Auto disponible</span>
    </div>
    <div class="legend-hint">
      <svg class="hint-icon" fill="none" viewBox="0 0 24 24" stroke="currentColor">
        <path
          stroke-linecap="round"
          stroke-linejoin="round"
          stroke-width="2"
          d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"
        />
      </svg>
      <span>Haz clic en un marcador para ver detalles</span>
    </div>
  </div>
</div>
