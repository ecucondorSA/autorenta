    <div class="rounded-lg border border-gray-200 bg-white p-6 shadow-sm">
      <h3 class="mb-4 text-lg font-semibold text-gray-900">Simulador de Liquidación</h3>

      <div class="mb-4 space-y-4">
        <div>
          <label class="block text-sm font-medium text-gray-700">
            Monto del Siniestro (USD)
          </label>
          <input
            type="number"
            [(ngModel)]="claimAmountUsd"
            min="0"
            step="0.01"
            class="mt-1 block w-full rounded-md border border-gray-300 px-3 py-2 shadow-sm focus:border-blue-500 focus:outline-none focus:ring-blue-500"
          />
        </div>

        <button
          (click)="simulate()"
          [disabled]="simulating()"
          class="rounded-lg bg-blue-600 px-4 py-2 text-sm font-medium text-white hover:bg-blue-700 disabled:opacity-50"
        >
          @if (simulating()) {
            <span class="flex items-center gap-2">
              <span class="h-4 w-4 animate-spin rounded-full border-2 border-white border-t-transparent"></span>
              Simulando...
            </span>
          } @else {
            Simular Waterfall
          }
        </button>
      </div>

      @if (simulationResult(); as result) {
        <div class="mt-6 space-y-4">
          @if (result.eligibility) {
            <div class="rounded-lg border p-4" [class.bg-green-50]="result.eligibility.eligible" [class.bg-red-50]="!result.eligibility.eligible">
              <h4 class="mb-2 font-semibold">
                Elegibilidad: {{ result.eligibility.eligible ? 'Elegible' : 'No Elegible' }}
              </h4>
              @if (result.eligibility.reasons.length > 0) {
                <ul class="list-disc pl-5 text-sm">
                  @for (reason of result.eligibility.reasons; track reason) {
                    <li>{{ reason }}</li>
                  }
                </ul>
              }
              @if (result.eligibility.eligible) {
                <p class="mt-2 text-sm">
                  Cobertura máxima: ${{ (result.eligibility.maxCoverCents / 100) | number: '1.2-2' }}
                </p>
              }
            </div>
          }

          @if (result.estimatedBreakdown) {
            <div class="rounded-lg border border-gray-200 bg-gray-50 p-4">
              <h4 class="mb-3 font-semibold">Desglose Estimado</h4>
              <div class="space-y-2 text-sm">
                @if (result.estimatedBreakdown.holdCaptured > 0) {
                  <div class="flex justify-between">
                    <span>Hold Capturado:</span>
                    <span class="font-medium">${{ result.estimatedBreakdown.holdCaptured / 100 | number: '1.2-2' }}</span>
                  </div>
                }
                @if (result.estimatedBreakdown.walletDebited > 0) {
                  <div class="flex justify-between">
                    <span>Wallet Debitado:</span>
                    <span class="font-medium">${{ result.estimatedBreakdown.walletDebited / 100 | number: '1.2-2' }}</span>
                  </div>
                }
                @if (result.estimatedBreakdown.extraCharged > 0) {
                  <div class="flex justify-between">
                    <span>Adicional:</span>
                    <span class="font-medium">${{ result.estimatedBreakdown.extraCharged / 100 | number: '1.2-2' }}</span>
                  </div>
                }
                @if (result.estimatedBreakdown.fgoPaid > 0) {
                  <div class="flex justify-between">
                    <span>FGO Pagado:</span>
                    <span class="font-medium">${{ result.estimatedBreakdown.fgoPaid / 100 | number: '1.2-2' }}</span>
                  </div>
                }
                @if (result.estimatedBreakdown.remainingUncovered > 0) {
                  <div class="flex justify-between border-t pt-2 font-semibold text-red-600">
                    <span>Sin Cubrir:</span>
                    <span>${{ result.estimatedBreakdown.remainingUncovered / 100 | number: '1.2-2' }}</span>
                  </div>
                }
              </div>
            </div>
          }
        </div>
      }

      @if (error()) {
        <div class="mt-4 rounded-lg bg-red-50 p-4 text-red-800">
          <p class="text-sm">{{ error() }}</p>
        </div>
      }
    </div>
