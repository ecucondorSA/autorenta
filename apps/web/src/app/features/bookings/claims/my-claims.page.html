<div class="claims-page">
  <!-- Header -->
  <div class="page-header">
    <div class="header-content">
      <div class="header-left">
        <h1 class="page-title">Mis Siniestros</h1>
        <p class="page-subtitle">Historial y estado de tus reportes</p>
      </div>

      <button class="btn-primary" (click)="reportNewClaim()">
        <svg class="btn-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M12 9v3m0 0v3m0-3h3m-3 0H9m12 0a9 9 0 11-18 0 9 9 0 0118 0z"
          />
        </svg>
        Reportar Nuevo Siniestro
      </button>
    </div>
  </div>

  <!-- Stats Cards -->
  <div class="stats-grid">
    <div class="stat-card">
      <div class="stat-icon">üìã</div>
      <div class="stat-content">
        <div class="stat-value">{{ stats().total }}</div>
        <div class="stat-label">Total</div>
      </div>
    </div>

    <div class="stat-card">
      <div class="stat-icon">‚è≥</div>
      <div class="stat-content">
        <div class="stat-value">{{ stats().pending }}</div>
        <div class="stat-label">Pendientes</div>
      </div>
    </div>

    <div class="stat-card">
      <div class="stat-icon">üîç</div>
      <div class="stat-content">
        <div class="stat-value">{{ stats().investigating }}</div>
        <div class="stat-label">En Investigaci√≥n</div>
      </div>
    </div>

    <div class="stat-card">
      <div class="stat-icon">‚úÖ</div>
      <div class="stat-content">
        <div class="stat-value">{{ stats().approved }}</div>
        <div class="stat-label">Aprobados</div>
      </div>
    </div>
  </div>

  <!-- Filters -->
  <div class="filters-section">
    <div class="filter-buttons">
      <button
        *ngFor="let filter of statusFilters"
        class="filter-btn"
        [class.active]="filterStatus() === filter.value"
        (click)="setFilter(filter.value)"
      >
        <span class="filter-icon">{{ filter.icon }}</span>
        {{ filter.label }}
        <span *ngIf="filter.value !== 'all'" class="filter-count">
          {{
            filter.value === 'pending'
              ? stats().pending
              : filter.value === 'investigating'
                ? stats().investigating
                : filter.value === 'approved'
                  ? stats().approved
                  : filter.value === 'rejected'
                    ? stats().rejected
                    : stats().closed
          }}
        </span>
      </button>
    </div>
  </div>

  <!-- Loading State -->
  <div *ngIf="loading()" class="loading-container">
    <div class="loading-spinner"></div>
    <p class="loading-text">Cargando siniestros...</p>
  </div>

  <!-- Empty State -->
  <div *ngIf="!loading() && !hasClaims()" class="empty-state">
    <svg class="empty-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
      <path
        stroke-linecap="round"
        stroke-linejoin="round"
        stroke-width="2"
        d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"
      />
    </svg>
    <h3 class="empty-title">No hay siniestros reportados</h3>
    <p class="empty-description">
      No tienes ning√∫n siniestro que coincida con los filtros seleccionados
    </p>
    <button class="btn-secondary mt-4" (click)="reportNewClaim()">Reportar un Siniestro</button>
  </div>

  <!-- Claims List -->
  <div class="claims-container" *ngIf="!loading() && hasClaims()">
    <div class="claims-list">
      <div *ngFor="let claim of filteredClaims()" class="claim-card" (click)="viewClaim(claim.id)">
        <!-- Claim Header -->
        <div class="claim-header">
          <div class="claim-icon">{{ getClaimTypeIcon(claim.claim_type) }}</div>
          <div class="claim-info">
            <h3 class="claim-title">{{ getClaimTypeLabel(claim.claim_type) }}</h3>
            <p class="claim-booking">
              Reserva:
              <a [routerLink]="['/bookings', claim.booking_id]" (click)="$event.stopPropagation()">
                #{{ claim.booking_id.substring(0, 8) }}
              </a>
            </p>
          </div>
          <div class="claim-status" [ngClass]="getStatusColor(claim.status)">
            {{ getStatusLabel(claim.status) }}
          </div>
        </div>

        <!-- Claim Body -->
        <div class="claim-body">
          <p class="claim-description">{{ claim.description }}</p>

          <div class="claim-details">
            <div class="claim-detail">
              <svg class="detail-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"
                />
              </svg>
              <span>{{ formatDate(claim.incident_date || claim.created_at) }}</span>
            </div>

            <div class="claim-detail" *ngIf="claim.incident_location">
              <svg class="detail-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"
                />
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M15 11a3 3 0 11-6 0 3 3 0 016 0z"
                />
              </svg>
              <span>{{ claim.incident_location }}</span>
            </div>

            <div class="claim-detail" *ngIf="claim.estimated_damage_amount">
              <svg class="detail-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"
                />
              </svg>
              <span>{{ formatCurrency(claim.estimated_damage_amount) }}</span>
            </div>
          </div>

          <!-- Photos Preview -->
          <div
            *ngIf="claim.evidence_photos && claim.evidence_photos.length > 0"
            class="claim-photos"
          >
            <div class="photos-label">üì∏ {{ claim.evidence_photos.length }} foto(s)</div>
          </div>
        </div>

        <!-- Claim Footer -->
        <div class="claim-footer">
          <span class="claim-date">Reportado {{ formatDate(claim.created_at) }}</span>
          <button class="claim-action" (click)="viewClaim(claim.id); $event.stopPropagation()">
            Ver Detalles
            <svg class="action-arrow" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M9 5l7 7-7 7"
              />
            </svg>
          </button>
        </div>
      </div>
    </div>
  </div>
</div>
