<section class="space-y-6">
  <header>
    <h1 class="h2">Mis reservas</h1>
    <p class="text-body">Seguimiento de tus pedidos y su estado actual.</p>
  </header>

  <!-- Error message -->
  <div *ngIf="error()" class="info-card-warm">
    <p class="font-semibold text-smoke-black">Error al cargar reservas</p>
    <p class="mt-1 text-charcoal-medium">{{ error() }}</p>
    <button
      (click)="loadBookings()"
      class="mt-3 px-3 py-2 bg-accent-warm text-white rounded-xl text-xs font-semibold hover:bg-accent-petrol transition-base"
    >
      Reintentar
    </button>
  </div>

  <!-- Loading state -->
  <div *ngIf="loading() && !error()" class="text-center text-sm text-charcoal-medium">
    Cargando reservas...
  </div>

  <!-- Bookings list -->
  <div class="space-y-4 sm:space-y-6" *ngIf="!loading() && !error()">
    <article
      *ngFor="let booking of bookings()"
      class="card-premium overflow-hidden hover-lift shadow-soft"
    >
      <a [routerLink]="['/bookings', booking.id]" class="block">
        <!-- Hero Section with Car Photo Background -->
        <div class="relative h-48 sm:h-56 md:h-64 overflow-hidden">
          <!-- Car Image Background -->
          <div *ngIf="booking.main_photo_url; else defaultBookingHero" class="absolute inset-0">
            <img
              [src]="booking.main_photo_url"
              [alt]="booking.car_title"
              loading="lazy"
              decoding="async"
              width="400"
              height="256"
              class="w-full h-full object-cover"
            />
            <!-- Dark Overlay -->
            <div class="absolute inset-0 bg-gradient-to-b from-smoke-black/60 via-smoke-black/40 to-smoke-black/70"></div>
          </div>

          <!-- Default Hero (no image) -->
          <ng-template #defaultBookingHero>
            <div class="absolute inset-0 bg-gradient-to-br from-accent-petrol via-accent-petrol/90 to-accent-warm">
              <!-- Decorative Pattern -->
              <div class="absolute inset-0 opacity-10" style="background-image: radial-gradient(circle, white 1px, transparent 1px); background-size: 40px 40px;"></div>
            </div>
          </ng-template>

          <!-- Content Overlay -->
          <div class="relative h-full flex flex-col justify-between p-4 sm:p-6">
            <!-- Top: Status Badge -->
            <div class="flex justify-between items-start">
              <span
                class="badge-status text-white border-white/30 backdrop-blur-sm"
                [ngClass]="{
                  'badge-warning': booking.status === 'pending',
                  'badge-success': booking.status === 'confirmed',
                  'badge-info': booking.status === 'in_progress',
                  'badge-neutral': booking.status === 'completed',
                  'badge-danger': booking.status === 'cancelled' || booking.status === 'expired'
                }"
              >
                {{ booking.status }}
              </span>
            </div>

            <!-- Bottom: Car Info -->
            <div class="text-white">
              <h3 class="text-xl sm:text-2xl font-bold mb-1 tracking-tight">
                {{ booking.car_title || 'Auto' }}
              </h3>
              <p class="text-sm sm:text-base text-white/90 mb-2" *ngIf="booking.car_brand || booking.car_model">
                {{ booking.car_brand }} {{ booking.car_model }}
              </p>
              <p class="text-xs sm:text-sm text-white/80">
                {{ rangeLabel(booking) }}
              </p>
            </div>
          </div>
        </div>

        <!-- Card Footer with Price and Action -->
        <div class="p-4 sm:p-5 bg-white-pure">
          <div class="flex items-center justify-between">
            <div>
              <p class="text-xs text-ash-gray mb-1">Total</p>
              <p class="text-lg sm:text-xl font-bold text-smoke-black">
                {{ booking.total_amount | money }}
              </p>
            </div>
            <div class="flex items-center gap-2 text-accent-petrol font-semibold text-sm hover:text-accent-warm transition-base">
              Ver detalle
              <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/>
              </svg>
            </div>
          </div>
        </div>
      </a>
    </article>
  </div>

  <!-- Empty state -->
  <p *ngIf="!loading() && !error() && bookings().length === 0" class="text-caption text-center py-8">
    No tenés reservas todavía.
  </p>
</section>
