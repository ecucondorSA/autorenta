<div
  class="fixed inset-0 top-0 bottom-0 overflow-hidden bg-slate-50 z-10 transition-colors duration-1000 ease-in-out"
>
  <!-- Fallback estático para cuando WebGL falla (móvil, algunos navegadores) -->
  <div
    class="absolute inset-0 z-0 bg-cover bg-center opacity-0 animate-[fadeIn_1.5s_ease-out_forwards]"
    style="background-image: url('/assets/hdri/laufenurg_church_1k.webp')"
  ></div>

  <!-- HDRI Background (WebGL) - se superpone al fallback cuando funciona -->
  <div class="absolute inset-0 z-[1] brightness-[1.1] saturate-[1.2] contrast-[1.05]">
    <app-hdri-background
      [srcLowDay]="'/assets/hdri/laufenurg_church_1k.webp'"
      [srcHighDay]="'/assets/hdri/laufenurg_church_8k.webp'"
      [srcLowNight]="'/assets/hdri/laufenurg_church_1k.webp'"
      [srcHighNight]="'/assets/hdri/laufenurg_church_8k.webp'"
      [autoRotate]="true"
      [rotateSpeed]="0.00002"
      [enableInteraction]="false"
      class="w-full h-full"
    >
    </app-hdri-background>
  </div>
  <div
    class="absolute inset-0 z-[2] bg-gradient-to-t from-black/80 via-black/40 to-transparent"
  ></div>

  <!-- Scenic CTAs with Glassmorphism Card -->
  <!-- bottom-[88px] en móvil para dejar espacio a la barra de navegación -->
  <div class="absolute bottom-[88px] left-0 right-0 z-10 px-4 sm:bottom-12 sm:px-6">
    <div class="mx-auto w-full max-w-sm">
      <!-- Glass Card - padding reducido en móvil -->
      <div
        class="backdrop-blur-xl bg-white/10 rounded-3xl p-4 sm:p-6 border border-white/20 shadow-2xl shadow-black/20"
      >
        <!-- Tagline - espaciado reducido en móvil -->
        <div class="text-center mb-4 sm:mb-6">
          <h1 class="text-lg sm:text-xl font-bold text-white mb-0.5 sm:mb-1 drop-shadow-md">
            Tu auto, tu plan
          </h1>
          <p class="text-white/70 text-xs sm:text-sm">Reservá cerca y salí</p>
        </div>

        <!-- Biometric Login - Estilo Banco (solo si hay credenciales guardadas) -->
        @if (biometricReady()) {
          <div class="flex flex-col items-center mb-4 sm:mb-6">
            <!-- Botón circular de huella con animación -->
            <button
              type="button"
              (click)="signInWithBiometric()"
              [disabled]="biometricLoading()"
              data-testid="login-biometric-button"
              class="group relative w-20 h-20 sm:w-24 sm:h-24 rounded-full bg-gradient-to-br from-emerald-400 to-emerald-600 shadow-xl shadow-emerald-500/40 hover:shadow-emerald-500/60 hover:scale-105 active:scale-95 transition-all duration-300 disabled:opacity-70 disabled:cursor-not-allowed"
            >
              <!-- Anillo pulsante exterior -->
              <span
                class="absolute inset-0 rounded-full border-2 border-emerald-300/50 animate-ping"
              ></span>
              <span class="absolute inset-[-4px] rounded-full border border-white/20"></span>

              <!-- Ícono de huella -->
              @if (!biometricLoading()) {
                <svg
                  class="w-10 h-10 sm:w-12 sm:h-12 mx-auto text-white drop-shadow-md"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="1.5"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    d="M7.864 4.243A7.5 7.5 0 0119.5 10.5c0 2.92-.556 5.709-1.568 8.268M5.742 6.364A7.465 7.465 0 004.5 10.5a7.464 7.464 0 01-1.15 3.993m1.989 3.559A11.209 11.209 0 008.25 10.5a3.75 3.75 0 117.5 0c0 .527-.021 1.049-.064 1.565M12 10.5a14.94 14.94 0 01-3.6 9.75m6.633-4.596a18.666 18.666 0 01-2.485 5.33"
                  />
                </svg>
              } @else {
                <!-- Spinner mientras carga -->
                <svg
                  class="w-10 h-10 sm:w-12 sm:h-12 mx-auto text-white animate-spin"
                  fill="none"
                  viewBox="0 0 24 24"
                >
                  <circle
                    class="opacity-25"
                    cx="12"
                    cy="12"
                    r="10"
                    stroke="currentColor"
                    stroke-width="3"
                  ></circle>
                  <path
                    class="opacity-75"
                    fill="currentColor"
                    d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"
                  ></path>
                </svg>
              }
            </button>

            <!-- Texto descriptivo -->
            <p class="mt-3 text-sm sm:text-base font-medium text-white/90 drop-shadow">
              @if (!biometricLoading()) {
                Toca para ingresar con {{ biometryLabel() }}
              } @else {
                Verificando...
              }
            </p>
            <p class="text-xs text-white/60">Acceso rápido y seguro</p>
          </div>

          <!-- Divider -->
          <div class="flex items-center gap-3 mb-4">
            <div class="h-px flex-1 bg-white/20"></div>
            <span class="text-xs text-white/50">o</span>
            <div class="h-px flex-1 bg-white/20"></div>
          </div>
        }

        <!-- CTA Buttons - espaciado y padding reducido en móvil -->
        <div class="space-y-2 sm:space-y-3" [class.block]="!isAuthenticated()">
          <button
            type="button"
            data-testid="login-scenic-signin"
            (click)="openForm()"
            class="w-full inline-flex items-center justify-center gap-2 rounded-2xl bg-accent-neon text-black font-bold py-3 sm:py-4 px-5 sm:px-6 shadow-lg shadow-accent-neon/30 hover:shadow-accent-neon/50 hover:scale-[1.02] active:scale-[0.98] transition-all duration-200"
          >
            <svg
              class="w-5 h-5"
              fill="none"
              viewBox="0 0 24 24"
              stroke="currentColor"
              stroke-width="2"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                d="M15.75 9V5.25A2.25 2.25 0 0013.5 3h-6a2.25 2.25 0 00-2.25 2.25v13.5A2.25 2.25 0 007.5 21h6a2.25 2.25 0 002.25-2.25V15m3 0l3-3m0 0l-3-3m3 3H9"
              />
            </svg>
            @if (biometricReady()) {
              Ingresar con email
            } @else {
              Ingresar
            }
          </button>

          @if (!isAuthenticated()) {
            <a
              routerLink="/auth/register"
              data-testid="login-scenic-register"
              class="w-full inline-flex items-center justify-center gap-2 rounded-2xl bg-white/10 text-white font-semibold py-3 sm:py-4 px-5 sm:px-6 border border-white/20 hover:bg-white/20 hover:border-white/30 transition-all duration-200"
            >
              <svg
                class="w-5 h-5"
                fill="none"
                viewBox="0 0 24 24"
                stroke="currentColor"
                stroke-width="2"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  d="M19 7.5v3m0 0v3m0-3h3m-3 0h-3m-2.25-4.125a3.375 3.375 0 11-6.75 0 3.375 3.375 0 016.75 0zM4 19.235v-.11a6.375 6.375 0 0112.75 0v.109A12.318 12.318 0 0110.374 21c-2.331 0-4.512-.645-6.374-1.766z"
                />
              </svg>
              Crear cuenta
            </a>
          }
        </div>

        <!-- Trust badges - ocultos en móvil pequeño, visibles en sm+ -->
        <div
          class="mt-3 sm:mt-5 hidden sm:flex flex-wrap items-center justify-center gap-2 sm:gap-4 text-white/50 text-xs"
        >
          <div class="flex items-center gap-1">
            <svg
              class="w-3 h-3 sm:w-3.5 sm:h-3.5"
              fill="none"
              viewBox="0 0 24 24"
              stroke="currentColor"
              stroke-width="2"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                d="M9 12.75L11.25 15 15 9.75m-3-7.036A11.959 11.959 0 013.598 6 11.99 11.99 0 003 9.749c0 5.592 3.824 10.29 9 11.623 5.176-1.332 9-6.03 9-11.622 0-1.31-.21-2.571-.598-3.751h-.152c-3.196 0-6.1-1.248-8.25-3.285z"
              />
            </svg>
            <span>Seguro</span>
          </div>
          <span class="text-white/30">·</span>
          <div class="flex items-center gap-1">
            <svg
              class="w-3 h-3 sm:w-3.5 sm:h-3.5"
              fill="none"
              viewBox="0 0 24 24"
              stroke="currentColor"
              stroke-width="2"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                d="M12 6v6h4.5m4.5 0a9 9 0 11-18 0 9 9 0 0118 0z"
              />
            </svg>
            <span>Rápido</span>
          </div>
          <span class="text-white/30">·</span>
          <div class="flex items-center gap-1">
            <svg
              class="w-3 h-3 sm:w-3.5 sm:h-3.5"
              fill="none"
              viewBox="0 0 24 24"
              stroke="currentColor"
              stroke-width="2"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                d="M9 12.75L11.25 15 15 9.75M21 12a9 9 0 11-18 0 9 9 0 0118 0z"
              />
            </svg>
            <span>Sin costos</span>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Login Modal - Professional Solid Design -->
  @if (showForm()) {
    <div
      class="fixed inset-0 z-[100] flex items-end sm:items-center justify-center bg-black/85 animate-fadeIn pb-[88px] sm:pb-0"
      (click)="closeForm()"
    >
      <div
        role="dialog"
        aria-modal="true"
        aria-labelledby="login-modal-title"
        class="w-full max-w-md max-h-[calc(100dvh-100px)] sm:max-h-[90dvh] overflow-y-auto bg-surface-elevated rounded-t-3xl sm:rounded-3xl shadow-elevation-4 animate-slideUp sm:animate-scaleIn"
        (click)="$event.stopPropagation()"
      >
        <!-- Header -->
        <div class="relative px-6 pt-6 pb-4">
          <button
            type="button"
            aria-label="Cerrar"
            (click)="closeForm()"
            class="absolute top-4 right-4 h-11 w-11 inline-flex items-center justify-center rounded-full bg-surface-secondary/80 hover:bg-surface-secondary active:scale-95 transition-all"
          >
            <svg
              class="w-5 h-5 text-text-secondary"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
            >
              <path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12" />
            </svg>
          </button>

          <div class="text-center pr-8">
            <div
              class="inline-flex items-center justify-center w-14 h-14 rounded-2xl bg-cta-default/10 mb-3"
            >
              <svg
                class="w-7 h-7 text-cta-default"
                fill="none"
                viewBox="0 0 24 24"
                stroke="currentColor"
                stroke-width="2"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  d="M15.75 6a3.75 3.75 0 11-7.5 0 3.75 3.75 0 017.5 0zM4.501 20.118a7.5 7.5 0 0114.998 0A17.933 17.933 0 0112 21.75c-2.676 0-5.216-.584-7.499-1.632z"
                />
              </svg>
            </div>
            <h2 id="login-modal-title" class="text-xl font-bold text-text-primary">Bienvenido de vuelta</h2>
            <p class="text-sm text-text-secondary mt-1">Ingresá a tu cuenta para continuar</p>
          </div>
        </div>

        <div class="px-6 pb-6">
          <!-- Passkey Quick Login - Solo visible si el dispositivo lo soporta -->
          @if (passkeysSupported()) {
            <button
              type="button"
              (click)="signInWithPasskey()"
              [disabled]="loading() || passkeysState() === 'authenticating'"
              data-testid="login-passkey-button"
              class="w-full mb-4 inline-flex items-center justify-center gap-3 py-3.5 px-4 rounded-2xl bg-gradient-to-r from-emerald-600 to-cta-default text-cta-text font-bold shadow-lg shadow-cta-default/20 hover:shadow-cta-default/40 hover:scale-[1.02] active:scale-[0.98] transition-all disabled:opacity-50 disabled:cursor-not-allowed"
            >
              @if (passkeysState() === 'authenticating') {
                <svg class="animate-spin h-5 w-5" fill="none" viewBox="0 0 24 24">
                  <circle
                    class="opacity-25"
                    cx="12"
                    cy="12"
                    r="10"
                    stroke="currentColor"
                    stroke-width="4"
                  ></circle>
                  <path
                    class="opacity-75"
                    fill="currentColor"
                    d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"
                  ></path>
                </svg>
                <span>Autenticando...</span>
              } @else {
                <!-- Fingerprint/Face ID Icon -->
                <svg
                  class="w-5 h-5"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    d="M7.864 4.243A7.5 7.5 0 0119.5 10.5c0 2.92-.556 5.709-1.568 8.268M5.742 6.364A7.465 7.465 0 004.5 10.5a7.464 7.464 0 01-1.15 3.993m1.989 3.559A11.209 11.209 0 008.25 10.5a3.75 3.75 0 117.5 0c0 .527-.021 1.049-.064 1.565M12 10.5a14.94 14.94 0 01-3.6 9.75m6.633-4.596a18.666 18.666 0 01-2.485 5.33"
                  />
                </svg>
                <span>Ingresar con huella o Face ID</span>
              }
            </button>
          }

          <!-- Social Login Buttons - Responsive Grid/Flex -->
          <div class="flex flex-wrap sm:grid sm:grid-cols-3 gap-2 mb-4">
            <button
              type="button"
              (click)="signInWithGoogle()"
              [disabled]="loading()"
              data-testid="login-google-button"
              class="flex-1 min-w-[100px] inline-flex items-center justify-center gap-1.5 py-3 px-2 rounded-2xl border border-border-default bg-surface-base text-text-primary font-medium hover:bg-surface-secondary hover:border-border-default/80 active:scale-95 transition-all disabled:opacity-50 disabled:cursor-not-allowed"
            >
              <svg class="w-5 h-5 flex-shrink-0" viewBox="0 0 48 48">
                <path
                  fill="#EA4335"
                  d="M24 9.5c3.13 0 5.2 1.35 6.4 2.48l4.36-4.36C31.97 5.2 28.3 3.5 24 3.5 14.9 3.5 7.2 8.88 4.1 16.7l5.23 4.06C11.08 14.33 17.1 9.5 24 9.5z"
                />
                <path
                  fill="#4285F4"
                  d="M46.1 24.5c0-1.43-.13-2.8-.37-4.12H24v7.8h12.4c-.54 2.9-2.18 5.35-4.64 7.02l5.37 4.17C41.9 42.4 46.1 34.4 46.1 24.5z"
                />
                <path
                  fill="#FBBC05"
                  d="M9.33 28.76c-.52-1.55-.82-3.2-.82-4.9 0-1.7.3-3.35.82-4.9L4.1 14.9C2.7 17.74 1.9 20.9 1.9 23.86c0 2.96.8 6.12 2.2 8.96l5.23-4.06z"
                />
                <path
                  fill="#34A853"
                  d="M24 44.2c6.3 0 11.6-2.08 15.46-5.65l-5.37-4.17c-2.18 1.46-4.98 2.33-10.1 2.33-6.9 0-12.92-4.83-14.67-11.26L4.1 32.82C7.2 40.64 14.9 44.2 24 44.2z"
                />
              </svg>
              <span class="text-xs font-semibold truncate">Google</span>
            </button>
            @if (facebookEnabled) {
              <button
                type="button"
                (click)="signInWithFacebook()"
                [disabled]="loading()"
                data-testid="login-facebook-button"
                class="flex-1 min-w-[100px] inline-flex items-center justify-center gap-1.5 py-3 px-2 rounded-2xl border border-border-default bg-surface-base text-text-primary font-medium hover:bg-surface-secondary hover:border-border-default/80 active:scale-95 transition-all disabled:opacity-50 disabled:cursor-not-allowed"
              >
                <svg
                  class="w-5 h-5 flex-shrink-0 text-[#1877F2]"
                  viewBox="0 0 24 24"
                  fill="currentColor"
                >
                  <path
                    d="M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"
                  />
                </svg>
                <span class="text-xs font-semibold truncate">Facebook</span>
              </button>
            }
            @if (tiktokEnabled) {
              <button
                type="button"
                (click)="signInWithTikTok()"
                [disabled]="loading()"
                data-testid="login-tiktok-button"
                class="flex-1 min-w-[100px] inline-flex items-center justify-center gap-1.5 py-3 px-2 rounded-2xl border border-border-default bg-surface-base text-text-primary font-medium hover:bg-surface-secondary hover:border-border-default/80 active:scale-95 transition-all disabled:opacity-50 disabled:cursor-not-allowed"
              >
                <svg class="w-5 h-5 flex-shrink-0" viewBox="0 0 24 24" fill="currentColor">
                  <path
                    d="M21 7.5a6.8 6.8 0 01-4.1-1.4V15a6 6 0 11-6-6c.2 0 .4 0 .6.03V12a3 3 0 10 2.4 2.94V2h3.1c.3 2.1 1.9 3.8 4 4v1.5z"
                  />
                </svg>
                <span class="text-xs font-semibold truncate">TikTok</span>
              </button>
            }
          </div>

          <!-- Divider -->
          <div class="flex items-center gap-3 my-5">
            <div class="h-px flex-1 bg-border-default/50"></div>
            <span class="text-xs text-text-muted font-medium">o con email</span>
            <div class="h-px flex-1 bg-border-default/50"></div>
          </div>

          <!-- Login Form -->
          <form (ngSubmit)="submit()" [formGroup]="form" class="space-y-4" data-testid="login-form">
            <!-- Email -->
            <div>
              <input
                id="login-email"
                name="email"
                type="email"
                formControlName="email"
                autocomplete="email webauthn"
                placeholder="tu@email.com"
                required
                data-testid="login-email-input"
                class="w-full px-5 py-4 rounded-2xl border-2 text-base font-medium tracking-tight transition-all focus:outline-none focus:ring-4 bg-surface-base text-text-primary placeholder:text-text-muted/60"
                [class.border-border-default]="
                  !form.controls.email.touched || !form.controls.email.invalid
                "
                [class.border-error-strong]="
                  form.controls.email.touched && form.controls.email.invalid
                "
                [class.focus:ring-cta-default/15]="
                  !form.controls.email.touched || !form.controls.email.invalid
                "
                [class.focus:border-cta-default]="
                  !form.controls.email.touched || !form.controls.email.invalid
                "
                aria-label="tu@email.com"
              />
              @if (form.controls.email.touched && form.controls.email.errors?.['required']) {
                <p class="mt-2 text-xs font-semibold text-error-strong px-1" role="alert">
                  El email es obligatorio
                </p>
              }
              @if (form.controls.email.touched && form.controls.email.errors?.['email']) {
                <p class="mt-2 text-xs font-semibold text-error-strong px-1" role="alert">
                  Formato de email inválido
                </p>
              }
            </div>

            <!-- Password -->
            <div>
              <input
                id="login-password"
                name="password"
                type="password"
                formControlName="password"
                autocomplete="current-password"
                placeholder="Contraseña"
                required
                data-testid="login-password-input"
                class="w-full px-5 py-4 rounded-2xl border-2 text-base font-medium tracking-tight transition-all focus:outline-none focus:ring-4 bg-surface-base text-text-primary placeholder:text-text-muted/60"
                [class.border-border-default]="
                  !form.controls.password.touched || !form.controls.password.invalid
                "
                [class.border-error-strong]="
                  form.controls.password.touched && form.controls.password.invalid
                "
                [class.focus:ring-cta-default/15]="
                  !form.controls.password.touched || !form.controls.password.invalid
                "
                [class.focus:border-cta-default]="
                  !form.controls.password.touched || !form.controls.password.invalid
                "
                aria-label="Contraseña"
              />
              @if (form.controls.password.touched && form.controls.password.errors?.['required']) {
                <p class="mt-2 text-xs font-semibold text-error-strong px-1" role="alert">
                  La contraseña es obligatoria
                </p>
              }
            </div>

            <!-- Forgot Password -->
            <div class="flex justify-end">
              <a
                routerLink="/auth/reset-password"
                class="text-xs text-cta-default hover:underline font-medium"
              >
                ¿Olvidaste tu contraseña?
              </a>
            </div>

            <!-- Error Message -->
            @if (error()) {
              <div class="bg-error-bg/50 border border-error-border rounded-xl p-3" role="alert">
                <div class="flex items-center gap-2">
                  <svg
                    class="w-4 h-4 text-error-strong flex-shrink-0"
                    viewBox="0 0 24 24"
                    fill="none"
                    stroke="currentColor"
                    stroke-width="2"
                  >
                    <path
                      stroke-linecap="round"
                      stroke-linejoin="round"
                      d="M12 9v3.75m9-.75a9 9 0 11-18 0 9 9 0 0118 0zm-9 3.75h.008v.008H12v-.008z"
                    />
                  </svg>
                  <p class="text-sm text-error-strong">{{ error() }}</p>
                </div>
              </div>
            }

            <!-- Submit Button -->
            <button
              type="submit"
              class="w-full py-4 rounded-xl bg-cta-default text-cta-text font-bold hover:shadow-lg hover:shadow-cta-default/30 transition-all disabled:opacity-50 disabled:cursor-not-allowed"
              [disabled]="form.invalid || loading()"
              data-testid="login-button"
            >
              @if (!loading()) {
                <span>Ingresar</span>
              }
              @if (loading()) {
                <span class="flex items-center justify-center gap-2">
                  <svg class="animate-spin h-5 w-5" fill="none" viewBox="0 0 24 24">
                    <circle
                      class="opacity-25"
                      cx="12"
                      cy="12"
                      r="10"
                      stroke="currentColor"
                      stroke-width="4"
                    ></circle>
                    <path
                      class="opacity-75"
                      fill="currentColor"
                      d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"
                    ></path>
                  </svg>
                  Ingresando...
                </span>
              }
            </button>
          </form>

          <!-- Register Link -->
          <div class="mt-5 text-center text-sm">
            <span class="text-text-secondary">¿Primera vez acá?</span>
            <a
              routerLink="/auth/register"
              class="text-cta-default hover:underline font-semibold ml-1"
            >
              Creá tu cuenta
            </a>
          </div>
        </div>
      </div>
    </div>
  }

  <!-- Biometric Setup Prompt - Estilo Banco -->
  @if (showBiometricPrompt()) {
    <div
      class="fixed inset-0 z-[200] flex items-center justify-center bg-black/90 animate-fadeIn p-4"
    >
      <div role="dialog" aria-modal="true" aria-labelledby="biometric-prompt-title" class="w-full max-w-sm bg-white rounded-3xl shadow-2xl animate-scaleIn overflow-hidden">
        <!-- Header con gradiente -->
        <div class="bg-gradient-to-br from-emerald-400 to-emerald-600 px-6 pt-8 pb-12 text-center">
          <!-- Ícono de huella animado -->
          <div
            class="relative inline-flex items-center justify-center w-24 h-24 rounded-full bg-white/20 mb-4"
          >
            <span
              class="absolute inset-0 rounded-full border-2 border-white/30 animate-ping"
            ></span>
            <svg
              class="w-12 h-12 text-white"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="1.5"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                d="M7.864 4.243A7.5 7.5 0 0119.5 10.5c0 2.92-.556 5.709-1.568 8.268M5.742 6.364A7.465 7.465 0 004.5 10.5a7.464 7.464 0 01-1.15 3.993m1.989 3.559A11.209 11.209 0 008.25 10.5a3.75 3.75 0 117.5 0c0 .527-.021 1.049-.064 1.565M12 10.5a14.94 14.94 0 01-3.6 9.75m6.633-4.596a18.666 18.666 0 01-2.485 5.33"
              />
            </svg>
          </div>
          <h2 id="biometric-prompt-title" class="text-xl font-bold text-white mb-1">¿Activar acceso rápido?</h2>
          <p class="text-white/80 text-sm">Ingresá con {{ biometryLabel() }} la próxima vez</p>
        </div>

        <!-- Contenido -->
        <div class="px-6 py-6 -mt-6 bg-white rounded-t-3xl">
          <!-- Beneficios -->
          <div class="space-y-3 mb-6">
            <div class="flex items-center gap-3 text-sm text-text-secondary">
              <div
                class="w-8 h-8 rounded-full bg-emerald-100 flex items-center justify-center flex-shrink-0"
              >
                <svg
                  class="w-4 h-4 text-emerald-600"
                  fill="none"
                  viewBox="0 0 24 24"
                  stroke="currentColor"
                  stroke-width="2"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    d="M13 10V3L4 14h7v7l9-11h-7z"
                  />
                </svg>
              </div>
              <span>Ingreso instantáneo sin escribir contraseña</span>
            </div>
            <div class="flex items-center gap-3 text-sm text-text-secondary">
              <div
                class="w-8 h-8 rounded-full bg-emerald-100 flex items-center justify-center flex-shrink-0"
              >
                <svg
                  class="w-4 h-4 text-emerald-600"
                  fill="none"
                  viewBox="0 0 24 24"
                  stroke="currentColor"
                  stroke-width="2"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    d="M9 12.75L11.25 15 15 9.75m-3-7.036A11.959 11.959 0 013.598 6 11.99 11.99 0 003 9.749c0 5.592 3.824 10.29 9 11.623 5.176-1.332 9-6.03 9-11.622 0-1.31-.21-2.571-.598-3.751h-.152c-3.196 0-6.1-1.248-8.25-3.285z"
                  />
                </svg>
              </div>
              <span>Tus datos protegidos en tu dispositivo</span>
            </div>
          </div>

          <!-- Botones -->
          <div class="space-y-3">
            <button
              type="button"
              (click)="acceptBiometricSetup()"
              [disabled]="biometricPromptLoading()"
              class="w-full py-4 rounded-2xl bg-gradient-to-r from-emerald-500 to-emerald-600 text-white font-bold shadow-lg shadow-emerald-500/30 hover:shadow-emerald-500/50 hover:scale-[1.02] active:scale-[0.98] transition-all disabled:opacity-70 disabled:cursor-not-allowed flex items-center justify-center gap-2"
            >
              @if (biometricPromptLoading()) {
                <svg class="animate-spin h-5 w-5" fill="none" viewBox="0 0 24 24">
                  <circle
                    class="opacity-25"
                    cx="12"
                    cy="12"
                    r="10"
                    stroke="currentColor"
                    stroke-width="4"
                  ></circle>
                  <path
                    class="opacity-75"
                    fill="currentColor"
                    d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"
                  ></path>
                </svg>
                <span>Verificando...</span>
              } @else {
                <svg
                  class="w-5 h-5"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    d="M7.864 4.243A7.5 7.5 0 0119.5 10.5c0 2.92-.556 5.709-1.568 8.268M5.742 6.364A7.465 7.465 0 004.5 10.5a7.464 7.464 0 01-1.15 3.993m1.989 3.559A11.209 11.209 0 008.25 10.5a3.75 3.75 0 117.5 0c0 .527-.021 1.049-.064 1.565M12 10.5a14.94 14.94 0 01-3.6 9.75m6.633-4.596a18.666 18.666 0 01-2.485 5.33"
                  />
                </svg>
                <span>Activar {{ biometryLabel() }}</span>
              }
            </button>

            <button
              type="button"
              (click)="skipBiometricSetup()"
              [disabled]="biometricPromptLoading()"
              class="w-full py-3 rounded-2xl text-text-secondary font-medium hover:bg-surface-secondary transition-all disabled:opacity-50"
            >
              Ahora no
            </button>
          </div>

          <p class="mt-4 text-xs text-text-muted text-center">
            Podés cambiar esto en Configuración → Seguridad
          </p>
        </div>
      </div>
    </div>
  }
</div>
